<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto Arbitrage Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-4">
    <h2 class="mb-4">ðŸ“Š Performance Chart</h2>

    <!-- Chart Toggle Buttons -->
    <div class="btn-group mb-3" role="group" aria-label="Chart toggles">
        <button class="btn btn-outline-primary" onclick="toggleChart('capital')">Capital</button>
        <button class="btn btn-outline-success" onclick="toggleChart('profit')">Profit</button>
        <button class="btn btn-outline-warning" onclick="toggleChart('trades')">Trades</button>
    </div>

    <!-- Chart Canvas -->
    <canvas id="growthChart" style="width:100%; height:400px;"></canvas>
</div>

<!-- Chart.js Library -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Chart Toggle Script -->
<script>
let chart;
let chartType = 'capital';

function fetchChartData() {
    fetch('/get_chart_data')
        .then(res => res.json())
        .then(data => {
            updateChart(data);
        });
}

function updateChart(data) {
    const labels = data.timestamps;
    const datasets = {
        capital: {
            label: 'Capital',
            data: data.capital,
            borderColor: '#0d6efd',
            backgroundColor: 'rgba(13, 110, 253, 0.1)',
            fill: true,
            tension: 0.3
        },
        profit: {
            label: 'Profit',
            data: data.profit,
            borderColor: '#198754',
            backgroundColor: 'rgba(25, 135, 84, 0.1)',
            fill: true,
            tension: 0.3
        },
        trades: {
            label: 'Trade Count',
            data: data.trade_count,
            borderColor: '#ffc107',
            backgroundColor: 'rgba(255, 193, 7, 0.1)',
            fill: true,
            tension: 0.3
        }
    };

    if (chart) chart.destroy();
    chart = new Chart(document.getElementById('growthChart'), {
        type: 'line',
        data: {
            labels: labels,
            datasets: [datasets[chartType]]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { display: true }
            },
            scales: {
                x: { display: true },
                y: { beginAtZero: true }
            }
        }
    });
}

function toggleChart(type) {
    chartType = type;
    fetchChartData();
}

document.addEventListener('DOMContentLoaded', fetchChartData);
</script>

</body>
</html>
